<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="data:text/css;charset=utf-8,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0A%2EsourceLine%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%7D%0Acode%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A" rel="stylesheet">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="fractionation-on-the-level-of-authors">Fractionation on the level of authors</h1>
<p>Stephan Stahlschmidt and Marion Schmidt<br />
22 Oktober, 2018</p>
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#potential-solution">Potential Solution</a></li>
<li><a href="#data-quality">Data Quality</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#caveats">Caveats</a></li>
<li><a href="#comparison-with-isi-fractionation-on-organization1">Comparison with ISI fractionation on organization1</a></li>
<li><a href="#scopus-scopus_b_2017">Scopus: scopus_b_2017</a>
<ul>
<li><a href="#implementation-in-scopus">Implementation in Scopus</a></li>
<li><a href="#comparison-with-isi-fractionation-on-organization1-1">Comparison with ISI fractionation on organization1</a></li>
</ul></li>
<li><a href="#summing-up">Summing up</a></li>
<li><a href="#appendix">Appendix</a>
<ul>
<li><a href="#kb-institution-encoding">KB institution encoding</a>
<ul>
<li><a href="#implementation-for-wos_b_2018">Implementation for wos_b_2018</a></li>
<li><a href="#implementation-for-scopus_b_2017">Implementation for scopus_b_2017</a></li>
</ul></li>
<li><a href="#conference-proceedings-web-of-science">Conference Proceedings Web of Science</a></li>
</ul></li>
<li><a href="#literatur">Literatur</a></li>
</ul>
<h1 id="motivation">Motivation</h1>
<p>Waltman and Eck (2015) demonstrate that whole counting is incompatible with field normalization. They propose fractional counting on the level of authors implemented by fractional counting on address strings.</p>
<p>In any such approach two issues arise:</p>
<ol>
<li>Several authors might be affiliated to the same organisation</li>
<li>Single authors might be affiliated with several organisations</li>
</ol>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> fk_authors, fk_institutions, <span class="kw">type</span>, <span class="kw">role</span>, organization1, countrycode
<span class="kw">FROM</span> wos_b_2018.items it
<span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.items_authors_institutions iai <span class="kw">ON</span> it.pk_items = iai.fk_items
<span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
<span class="kw">WHERE</span> ut_eid = <span class="st">'000262133500009'</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">FK_AUTHORS</th>
<th align="right">FK_INSTITUTIONS</th>
<th align="left">TYPE</th>
<th align="left">ROLE</th>
<th align="left">ORGANIZATION1</th>
<th align="left">COUNTRYCODE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">7955236</td>
<td align="right">21820728</td>
<td align="left">RS</td>
<td align="left">author</td>
<td align="left">Charles Univ Prague</td>
<td align="left">CZE</td>
</tr>
<tr class="even">
<td align="right">10052410</td>
<td align="right">21820728</td>
<td align="left">RS</td>
<td align="left">author</td>
<td align="left">Charles Univ Prague</td>
<td align="left">CZE</td>
</tr>
<tr class="odd">
<td align="right">10052410</td>
<td align="right">3813050</td>
<td align="left">RS</td>
<td align="left">author</td>
<td align="left">IPN</td>
<td align="left">MEX</td>
</tr>
<tr class="even">
<td align="right">12295429</td>
<td align="right">21820728</td>
<td align="left">RS</td>
<td align="left">author</td>
<td align="left">Charles Univ Prague</td>
<td align="left">CZE</td>
</tr>
<tr class="odd">
<td align="right">19601371</td>
<td align="right">NA</td>
<td align="left">RS</td>
<td align="left">researcher_id</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">21176674</td>
<td align="right">26576092</td>
<td align="left">RP</td>
<td align="left">author</td>
<td align="left">Sincrotrone Trieste SCpA</td>
<td align="left">ITA</td>
</tr>
<tr class="odd">
<td align="right">21176674</td>
<td align="right">21820728</td>
<td align="left">RS</td>
<td align="left">author</td>
<td align="left">Charles Univ Prague</td>
<td align="left">CZE</td>
</tr>
<tr class="even">
<td align="right">21176674</td>
<td align="right">11533142</td>
<td align="left">RS</td>
<td align="left">author</td>
<td align="left">Sincrotrone Trieste SCpA</td>
<td align="left">ITA</td>
</tr>
<tr class="odd">
<td align="right">24438445</td>
<td align="right">NA</td>
<td align="left">RS</td>
<td align="left">researcher_id</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<h1 id="potential-solution">Potential Solution</h1>
<p>Fractional counting based on author attribution and subsequent aggregation to the levle of interest (here: countries) might be computed as follows:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> cntry_frac <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution of organsation on author level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, organization1, countrycode, fk_authors,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> fk_authors) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) / 
        (<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_authors)) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> wos_b_2018.items it
      <span class="kw">JOIN</span> wos_b_2018.items_authors_institutions iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> ut_eid = <span class="st">'000262133500009'</span>
        <span class="kw">AND</span> <span class="kw">role</span> = <span class="st">'author'</span>
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">FK_ITEMS</th>
<th align="left">COUNTRYCODE</th>
<th align="right">CNTRY_FRAC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">28825338</td>
<td align="left">ITA</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="right">28825338</td>
<td align="left">CZE</td>
<td align="right">0.750</td>
</tr>
<tr class="odd">
<td align="right">28825338</td>
<td align="left">MEX</td>
<td align="right">0.125</td>
</tr>
</tbody>
</table>
<p>The <em>KB</em> versions of <em>Web of Science</em> and <em>Scopus</em> differ in their usage of <em>fk_authors</em>, <em>type</em> and <em>role</em> (Why?). WoS holds the same <em>fk_authors</em> as a corresponding author (<em>RP</em>) and as an ordinary author (<em>RS</em>), while SCP assigns two different <em>fk_authors</em> for the same author which vary in their type (<em>RP</em> or <em>RS</em>). In any case entries for corresponding authors have to excluded via the <em>RP</em> type. Furthermore in the WoS authors have to be separated from other roles via <em>role = 'author'</em>.</p>
<h1 id="data-quality">Data Quality</h1>
<p>Necessary information in variables like <em>Organization1</em>, <em>role</em> and <em>type</em> might not always be available and especially before 2008 the link between authors (<em>fk_authors</em>) and their affiliated organisation (<em>fk_institutions</em>) was most often only recorded for the corresponding author.</p>
<p>Percentages of pk_items with partially missing information:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">only pk_item</th>
<th align="right">no type</th>
<th align="right">no role</th>
<th align="right">no affiliation</th>
<th align="right">no author</th>
<th align="right">No Organization1</th>
<th align="right">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2007</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">85.9</td>
<td align="right">88.9</td>
<td align="right">85.9</td>
<td align="right">2.1</td>
<td align="right">89.7</td>
</tr>
<tr class="even">
<td>2008</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">14.2</td>
<td align="right">20.3</td>
<td align="right">14.2</td>
<td align="right">2.3</td>
<td align="right">23.7</td>
</tr>
<tr class="odd">
<td>2009</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">13.1</td>
<td align="right">20.2</td>
<td align="right">13.1</td>
<td align="right">2.3</td>
<td align="right">23.4</td>
</tr>
<tr class="even">
<td>2010</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">12.5</td>
<td align="right">19.0</td>
<td align="right">12.5</td>
<td align="right">2.2</td>
<td align="right">22.2</td>
</tr>
<tr class="odd">
<td>2011</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">11.7</td>
<td align="right">17.6</td>
<td align="right">11.7</td>
<td align="right">2.1</td>
<td align="right">20.8</td>
</tr>
<tr class="even">
<td>2012</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">11.1</td>
<td align="right">16.9</td>
<td align="right">11.1</td>
<td align="right">2.0</td>
<td align="right">19.8</td>
</tr>
<tr class="odd">
<td>2013</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">10.4</td>
<td align="right">12.3</td>
<td align="right">10.4</td>
<td align="right">1.9</td>
<td align="right">15.5</td>
</tr>
<tr class="even">
<td>2014</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">9.9</td>
<td align="right">10.6</td>
<td align="right">9.9</td>
<td align="right">1.8</td>
<td align="right">13.9</td>
</tr>
<tr class="odd">
<td>2015</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">9.7</td>
<td align="right">8.4</td>
<td align="right">9.7</td>
<td align="right">1.7</td>
<td align="right">13.4</td>
</tr>
<tr class="even">
<td>2016</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">10.9</td>
<td align="right">2.9</td>
<td align="right">10.9</td>
<td align="right">1.7</td>
<td align="right">14.2</td>
</tr>
<tr class="odd">
<td>2017</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">9.1</td>
<td align="right">2.8</td>
<td align="right">9.1</td>
<td align="right">1.8</td>
<td align="right">12.4</td>
</tr>
</tbody>
</table>
<p><img src="data:image/png;base64,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" /></p>
<!-- ```{r tab_dif_author_counting, echo = FALSE, eval = FALSE} -->
<!-- # Differenz zwischen author_cnt und ZÃ¤hlung der fk_authors -->
<!-- dif_author_counting <- dbGetQuery(sql_pool, strwrap(paste0(" -->
<!--   SELECT pubyear, SUM(diff) -->
<!--   FROM( -->
<!--     SELECT DISTINCT fk_items, pubyear, -->
<!--       CASE  WHEN author_cnt = (COUNT(DISTINCT fk_authors) OVER (PARTITION BY fk_items)) -->
<!--               THEN 0 -->
<!--             ELSE 1 -->
<!--       END diff -->
<!--     FROM wos_b_2018.items it -->
<!--     JOIN wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai ON it.pk_items = iai.fk_items -->
<!--     WHERE pubtype = 'Journal' -->
<!--       AND doctype IN ('Article', 'Review') -->
<!--       AND pubyear BETWEEN 2007 AND 2017 -->
<!--       AND type = 'RS' -->
<!--       AND role = 'author' -->
<!--   ) -->
<!--   GROUP BY pubyear -->
<!--   ORDER BY pubyear ASC -->
<!--   "), -->
<!--   width = 100000, simplify = TRUE) -->
<!--   ) -->
<!-- ``` -->
<!-- Prozentualer Anteil von pk_items mit Unterschieden in author_cnt und ZÃ¤hlung der zugehÃ¶rigen fk_authors: -->
<!-- ```{r tab_diff, echo = FALSE, eval = FALSE} -->
<!-- tmp <- as.matrix(dif_author_counting[,2]/papersByYear[,2] * 100) -->
<!-- rownames(tmp) <- as.character(2007:2017) -->
<!-- kable(tmp, -->
<!--       digits = 1, -->
<!--       row.names = TRUE, -->
<!--       col.names=c("# Autoren != author_cnt")) -->
<!-- matplot(2007:2017, tmp, -->
<!--      xlim=c(2007,2017), -->
<!--      ylim=c(0,100), -->
<!--      lwd=2, -->
<!--      lty=1, -->
<!--      bty="n", -->
<!--      xlab="", -->
<!--      ylab="%", -->
<!--      type="l", -->
<!--      col=viridis(2)) -->
<!-- # legend("topright", -->
<!-- #        legend = c("# Autoren != author_cnt", "# Affiliationen != inst_cnt"), -->
<!-- #        fill=viridis(2), -->
<!-- #        bty = "n") -->
<!-- ``` -->
<h1 id="implementation">Implementation</h1>
<p>Due to large shares of items with incomplete information we propose a hybrid spproach. We (1) fractionalize on the author level (and subsequently aggregate to the country level) for every pk_item with complete information in the <em>items_authors_institutions</em> table and (2) apply fractionalization on the organisation level (and therefore ignore any authors) via <em>organization1</em> for all other pk_items. Hence we follow Waltman and Eck (2015) but account for data quality issues at the same time.</p>
<p>In detail we compute a table which holds country specific weights for fractional counting. Lower aggregates levels like organisations might also be computed.</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">DROP</span> <span class="kw">TABLE</span> items_iai_complete;
<span class="kw">DROP</span> <span class="kw">TABLE</span> wosb2018_frc_cntrylvl;

<span class="co">/*</span>
<span class="co">Create temporaray table as an indicator of items with complete iai record:</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">GLOBAL</span> <span class="kw">TEMPORARY</span> <span class="kw">TABLE</span> items_iai_complete (
    fk_items <span class="dt">NUMBER</span>
)
<span class="kw">ON</span> <span class="kw">COMMIT</span> <span class="kw">DELETE</span> <span class="kw">ROWS</span>;

<span class="co">/*</span>
<span class="co">create empty table defining fractional weight for every paper by country</span>
<span class="co">causes implicit commit</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">TABLE</span> wosb2018_frc_cntrylvl (
    fk_items <span class="dt">NUMBER</span>,
    countrycode <span class="dt">VARCHAR2</span>(<span class="dv">10</span> <span class="dt">CHAR</span>),
    frac_share <span class="dt">NUMBER</span>(<span class="dv">3</span>,<span class="dv">2</span>),
    ind_complete <span class="dt">NUMBER</span>(<span class="dv">1</span>,<span class="dv">0</span>)
);

<span class="co">/*</span>
<span class="co">populate temporary table</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> items_iai_complete (
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items <span class="co">-- subset of items with complete iai information</span>
<span class="kw">FROM</span>( <span class="co">-- counts numbers of entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> wos_b_2018.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> (<span class="kw">role</span> <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> <span class="kw">role</span> = <span class="st">'author'</span>) <span class="co">-- we only care for authors and missing information, other roles are neglected</span>
        <span class="kw">AND</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp
<span class="kw">JOIN</span>( <span class="co">-- counts numbers of COMPLETE entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> wos_b_2018.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> fk_institutions <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> fk_authors <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> <span class="kw">role</span> = <span class="st">'author'</span>
        <span class="kw">AND</span> <span class="kw">type</span> <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp2 <span class="kw">ON</span> tmp.fk_items = tmp2.fk_items
<span class="kw">AND</span> tmp.entry_cnt = tmp2.entry_cnt); <span class="co">-- compare both numbers</span>

<span class="co">/*</span>
<span class="co">include items with COMPLETE iai information via fractional counting on author level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> wosb2018_frc_cntrylvl
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share, <span class="dv">1</span> <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution of organsation on author level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode, fk_authors,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> fk_authors) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items)))
        /(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_authors)) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> wos_b_2018.items it
      <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> <span class="kw">role</span> = <span class="st">'author'</span>
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode, <span class="dv">1</span>;

<span class="co">/*</span>
<span class="co">include items with INCOMPLETE iai information via fractional counting on organization level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> wosb2018_frc_cntrylvl
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share, <span class="dv">0</span> <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution on organisation level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> wos_b_2018.items it
      <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> (<span class="kw">role</span> = <span class="st">'author'</span> <span class="kw">OR</span> <span class="kw">role</span> <span class="kw">IS</span> <span class="kw">NULL</span>)
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode, <span class="dv">0</span>;

<span class="kw">CREATE</span> <span class="kw">INDEX</span> wosb2018_frc_cntrylvl_ix <span class="kw">ON</span> wosb2018_frc_cntrylvl (fk_items, countrycode);

<span class="kw">COMMIT</span>;</code></pre></div>
<h1 id="caveats">Caveats</h1>
<ul>
<li>Whenever an authors holds several affiliations of which two or more actually describe the same organisation, but have not been cleaned in <em>organization1</em>, we assign erroneous weights. This issue might be less severe on a country level analysis and could ultimately only be resolved via a worldwide institution harmonization.</li>
<li>Affiliations without an <em>organzation1</em> are omitted, e.g. private addresses (1,2% in wos_b_2018)</li>
<li>anonymous authors (<em>role = 'anon'</em>) are omitted</li>
<li>Any other?</li>
</ul>
<h1 id="comparison-with-isi-fractionation-on-organization1">Comparison with ISI fractionation on organization1</h1>
<p>As an alternative implementation we also compute weights based on fractionation on the <em>organization1</em> level:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">
<span class="co">/*</span>
<span class="co">create empty table defining fractional weight for every paper by country</span>
<span class="co">based on fractionation on organization1 level</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">TABLE</span> wosb2018_frc_cntrylvl_org1 (
    fk_items <span class="dt">NUMBER</span>,
    countrycode <span class="dt">VARCHAR2</span>(<span class="dv">10</span> <span class="dt">CHAR</span>),
    frac_share <span class="dt">NUMBER</span>(<span class="dv">3</span>,<span class="dv">2</span>)
);

<span class="co">/*</span>
<span class="co">include items with INCOMPLETE iai information via fractional counting on organization level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> wosb2018_frc_cntrylvl_org1
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution on organisation level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> wos_b_2018.items it
      <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> (<span class="kw">role</span> = <span class="st">'author'</span> <span class="kw">OR</span> <span class="kw">role</span> <span class="kw">IS</span> <span class="kw">NULL</span>)
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode;

<span class="kw">CREATE</span> <span class="kw">INDEX</span> wosb2018_frc_cntrylvl_org1_ix <span class="kw">ON</span> wosb2018_frc_cntrylvl_org1 (fk_items, countrycode);

<span class="kw">COMMIT</span>;</code></pre></div>
<p>Computing fractional counts of publications on national level for 2017:</p>
<pre><code>##    COUNTRY PUBYEAR PUB_CNT_FRAK COUNTRY PUBYEAR PUB_CNT_FRAK_ISI
## 1      USA    2017    328073.57     USA    2017        331041.62
## 2      CHN    2017    311121.04     CHN    2017        305744.47
## 3      GBR    2017     78520.46     GBR    2017         79872.01
## 4      DEU    2017     75084.54     DEU    2017         74758.39
## 5      JPN    2017     66966.03     JPN    2017         67103.65
## 6      IND    2017     64531.10     IND    2017         64106.29
## 7      ITA    2017     50607.04     KOR    2017         50231.04
## 8      KOR    2017     50598.08     ITA    2017         49944.34
## 9      FRA    2017     48023.17     FRA    2017         48992.85
## 10     CAN    2017     47401.28     CAN    2017         47639.40
## 11     ESP    2017     42819.01     ESP    2017         42589.21
## 12     BRA    2017     40370.46     BRA    2017         39833.05
## 13     RUS    2017     31265.91     RUS    2017         31452.20
## 14     NLD    2017     24824.52     NLD    2017         24555.48
## 15     POL    2017     22399.12     POL    2017         22297.40
## 16     CHE    2017     16814.71     CHE    2017         16910.97
## 17     SWE    2017     16648.02     SWE    2017         16837.00
## 18     BEL    2017     12704.28     BEL    2017         12672.35
## 19     DNK    2017     11627.22     DNK    2017         11566.10
## 20     ISR    2017     10329.89     ISR    2017         10336.78
## 21     ZAF    2017      9759.97     ZAF    2017          9754.36
## 22     AUT    2017      9094.32     AUT    2017          9044.01
## 23     FIN    2017      8251.95     FIN    2017          8184.44</code></pre>
<p>Only Italy and Korea swap places in this ranking of productivity.</p>
<h1 id="scopus-scopus_b_2017">Scopus: scopus_b_2017</h1>
<p>Data quality seems to be better in Scopus. However, the field <em>organization1</em> is not as much structured in Scopus as in WoS, consequently as an alternative one could consider to use the Scopus institution harmonization <em>AFID</em> in the Rohdatenbank instead of <em>organization1</em>. However an uniformly detailed affiliation assignment in <em>organization1</em> might not have substantial effects on country statistics, while the <em>pk_kb_inst</em> should jointly for all German institution include several of these detailied sub-organization affiliations and consequently validate a relative comparison among German institutions.</p>
<p>Percentages of pk_items with partially missing information (Scopus):</p>
<table>
<colgroup>
<col width="5%"></col>
<col width="21%"></col>
<col width="13%"></col>
<col width="19%"></col>
<col width="20%"></col>
<col width="14%"></col>
<col width="6%"></col>
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="right">no author nor affiliation</th>
<th align="right">no author type</th>
<th align="right">author w/o affiliation</th>
<th align="right">affiliation w/o authors</th>
<th align="right">no organization1</th>
<th align="right">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2007</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5.7</td>
<td align="right">0.0</td>
<td align="right">2.5</td>
<td align="right">7.9</td>
</tr>
<tr class="even">
<td>2008</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5.0</td>
<td align="right">0.0</td>
<td align="right">2.4</td>
<td align="right">7.1</td>
</tr>
<tr class="odd">
<td>2009</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5.0</td>
<td align="right">0.0</td>
<td align="right">2.1</td>
<td align="right">6.9</td>
</tr>
<tr class="even">
<td>2010</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6.1</td>
<td align="right">0.0</td>
<td align="right">2.1</td>
<td align="right">7.9</td>
</tr>
<tr class="odd">
<td>2011</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5.7</td>
<td align="right">0.0</td>
<td align="right">2.1</td>
<td align="right">7.5</td>
</tr>
<tr class="even">
<td>2012</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5.3</td>
<td align="right">0.0</td>
<td align="right">1.9</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td>2013</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4.8</td>
<td align="right">0.0</td>
<td align="right">1.8</td>
<td align="right">6.4</td>
</tr>
<tr class="even">
<td>2014</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3.8</td>
<td align="right">0.1</td>
<td align="right">1.9</td>
<td align="right">5.5</td>
</tr>
<tr class="odd">
<td>2015</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3.2</td>
<td align="right">0.3</td>
<td align="right">1.9</td>
<td align="right">5.1</td>
</tr>
<tr class="even">
<td>2016</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2.1</td>
<td align="right">0.3</td>
<td align="right">1.9</td>
<td align="right">3.9</td>
</tr>
</tbody>
</table>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAilBMVEUAAAAAADoAAGYAOjoAOpAAZrYiqIQqeI46AAA6ADo6AGY6OgA6Ojo6OpA6kJA6kNtBRIdEAVRmAABmADpmAGZmkJBmtrZmtv960VGQOgCQOjqQZgCQkGaQtpCQ27aQ2/+2ZgC2tma225C2/7a2///bkDrb/7bb///95yX/tmb/25D//7b//9v///+CNoOxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARzElEQVR4nO3dD3/axgGHcTmNW6frRkPWul67ma3RMsC8/7c33Z3+nAAJDt2dfsjP9/NJgsGWjP1ESEInFQdAWDH3NwCMIVBII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BICwv07aWwPnxN9O0AfUGBlsXK3dg2N4C0QgJ9e2mzLD9+S/DNAMdCAt2vn5ubW17kkQVLUEgLXAetF6GsgyKTsK34/dptxbP8RCbsB4U0AoU0dtRDGjvqIY3dTJAWZ0d90Yr2jQFG5CUogSKuyDvqCRRxRd5RT6CIK3JRBCql8PUf2j4PfOBtaSgg0CUrPnf6v5pehsMfzI9Al4xAE08O0wwGunuyGxLb6pV/1XywqT54vutAm02kkTc7CVTKhSXotgpyv350H2weD4fy4fWeAz28vVx6E55ApYwH6vZrbx9ezQf7L69mwfp814FWT+kx5uSQ2HigJkcbZdPktijuPFD7ohBxckjrmkCrW7bJslpv+8+9L0FzTw7TBCxB7Qd3/xKfe3KYZnhH/ck6qD38Z3v3L/GZJ4dU9uuVvxW/qheexYpAIWHT7Qd1H1TroA+vG7c4FUKgkEagkEagkEagkEagkEagkEagkEagSzb8TlJzYNrmdHiZOTz0wiEX1tkdptuRt6J2P95wQhoCXbLi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Jvrmkgn1aI/uYdvvT/1DK5tA26Eg9lO7v6I/BenJYZpLgTanoa//daM97MPNAfXVGsA/P/n7FNtAm6EgBIqbBS5B3WgP+3AX6MocV999YX8JevDbJFAEGt5R71/Low3UjfYwvBEfq3543TpofSeBIgX/Wh7tS327P6kd8eEOEPI2z9sNpGYoCIEiCf9aHk2gu0/t63Y94sO22IxZMtzY+WY/qD0+mECRiR3tYW+oHK9MoPCUzR4lAoWeerSHu/l89FC9pZV9+DGBQlqvqPoogFiTAybzi9qbvbTbSYUSKOLyi7LbcPu/TzkkhUARlyvKvS3AEhRymqI2xbNbB512TB+BIq6uqE2MM+UTKOLyiyqHB8PdMjlgurooc15Fe3jAtL1MBIrIXFF2JMrux69mNXTSSiiBIq56K97sW3r7x/S3sQgUcR0vQaNMDoilLspcoSvGcQAEirg4WATSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSwooyR+UVxcjQTwJFXEFFtec33Q6NACVQxBVSVH2lY4OLySKP0Mtx17gcN/JgCQppgeug9SKUdVBkElaUOb+DMXh6BwJFXOwHhbQ4RQ1cLQqY6paiRi4BQaCIK2w3U7ekZDcTsggqqt54ZwmKbEK34s32O4Eim9CiNg+vBIp8gosqixWBIpvwonZP3xEocrmhqLeXgkCRCe8kQRqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQhqBQlpYUW8vo9c6JlDEFlRU6a523F72eOLkgItCinp7abMszVWPJ04OuCykqP26vQTiduBFnkARF0tQSAtcB60XoayDIpOwovZrtxU/sPwkUMTGflBIi1NU0YoyOaARVlRZJWhXQ0u24pFF2EbSw2u1Gvp4IFDkEr6b6e2l2kQiUORxy476zcdvBIo8btpRv3kkUOQRtg5aZ7lfDx3PRKCIK3Qr3r3Iv70QKLJgRz2kESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikEajv89zfAI7lCPTzmLjzDzH6bYWa72ks3OyBZvq1x0txzmfxDs39Er+QcCS+iUWaO9BR8VpczKqEwhPKSjrQ7L7PPkeaveAdB/p9TNm/+/fSbI5AFX6zUWuMKeJzXGSzswc6o4jPW/UbvHVlQafsuV/i0/xmk/yyk8j/hO6s2bkDxTCx/4TzNEugd+q9NEugyyHb7JTpEeiiBa8lzFf2AAJ9b+6sWQLFleZpNkegP78DcX+M9yJDswSK5KIXJTO5uzF3Atqm/GQJFNLCinp7KayBax0TKGILu158sXI3ts2NSZPDXfnhZlPmGlLU20ubZfnxW8Dkbn9qWIKgIq8q6rz9+rm5ue2/yBetc183988Hcfx2qxvbdGkFfO4VS1AgrsB10HoROrgOCsQVtlWzX7sXcpafyITNbkgjUEgjUEgjUEgjUEgjUEgjUEgjUEiTDrTAIkxqIFZMKWT/5vL/NJhjyi9OjUCZI4HOOkPmmPSLUyNQ5kigs86QOSb94tQIlDkS6KwzZI5Jvzg1AmWOBDrrDJlj0i8GUiNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSFMK1F5DxJ4Zd1sUD6+9G2X10PPYF0ea4eGw+/Hr0T155tg9lGuOxib+qV7H5rh7KorHoKkJBfr2Uj2b0nz/2+qG+dPdKM2N2IWemaE5R689/b53T545dg/lmqOxjX8u4tGfajW3/TroOQoFunsyAZYfvrpz4W8eD96NR3cj8Qztf3qXS3tPpjm2D2Wb48GeMTt6oBd/qmHPUShQp/ov1z5F77mmCPR0hubk+9uEuYzMsX0o5xzLj78nOpv7+Z/qp/BnJxfopurSPo+tdyPNS/zpDA/NP717ssyxfSjjHKv7EqyDDs9x++HPdeh6tlqg5vohbjFS/d3eSLXNcjxDe4f9Ufr3ZJlj+1C+OZpX3ESBnp9jaV7o3avh1cQC3TYr10eBmiXL7inBb68/Q3tP4kAH5tg+lG+O5mJXaQIdmGP5EP66pBWoW4KcvsQnWyU8muGh+SfdS/zQHNuHss3R3pMk0KE5ul+g+2VeSyrQ+mK1pxtJqRZoxzM0H6TdSBqco3ep3kxzLOuTI0Zfsx+co3uiYZtKSoE2F7I73c3knmv0BdrJDA/NXBLtZhqZY3cZv2xzNBIsQYfn6C72ercv8d065umO+iTroGdmeGh+fml21I/MMcka9vhzNOIHOjZHs9brXfH1GkKB1i859o0j7x1Od2OT4H3AczP0XnAT7DYYmaP3UKY5WvEDHZ3jNvjXKBQocIpAIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIY1AIe3/Buyr8CfeBioAAAAASUVORK5CYII=" /></p>
<!-- ```{r, tab_dif_author_counting_sc, echo=FALSE, eval=FALSE} -->
<!-- # Differenz zwischen author_cnt und ZÃ¤hlung der fk_authors -->
<!-- dif_author_counting_sc <- dbGetQuery(sql_pool, strwrap(paste0(" -->
<!--   SELECT pubyear, SUM(diff) -->
<!--   FROM( -->
<!--     SELECT DISTINCT fk_items, pubyear, -->
<!--       CASE  WHEN author_cnt = (COUNT(DISTINCT fk_authors) OVER (PARTITION BY fk_items)) -->
<!--               THEN 0 -->
<!--             ELSE 1 -->
<!--       END diff -->
<!--     FROM scopus_b_2017.items it -->
<!--     JOIN scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai ON it.pk_items = iai.fk_items -->
<!--     WHERE pubtype = 'J' -->
<!--     AND doctype IN ('ar', 're') -->
<!--     AND pubyear BETWEEN 2007 AND 2016 -->
<!--     AND (type = 'RS' OR type IS NULL) -->
<!--   ) -->
<!--   GROUP BY pubyear -->
<!--   ORDER BY pubyear ASC -->
<!--   "), -->
<!--   width = 100000, simplify = TRUE) -->
<!--   ) -->
<!-- ``` -->
<!-- Prozentualer Anteil von pk_items mit Unterschieden in author_cnt und ZÃ¤hlung der zugehÃ¶rigen fk_authors (Scopus): -->
<!-- ```{r, tab_diff_sc, echo=FALSE, eval=FALSE, cache=FALSE} -->
<!-- tmp <- as.matrix(dif_author_counting_sc[,2]/papersByYear_sc[,2] * 100) -->
<!-- rownames(tmp) <- as.character(2007:2016) -->
<!-- colnames(tmp) <- c("# Autoren != author_cnt") -->
<!-- kable(tmp, -->
<!--       digits = 1, -->
<!--       row.names = TRUE) -->
<!-- matplot(2007:2016, tmp, -->
<!--      xlim=c(2007,2016), -->
<!--      ylim=c(0,100), -->
<!--      lwd=2, -->
<!--      lty=1, -->
<!--      bty="n", -->
<!--      xlab="", -->
<!--      ylab="%", -->
<!--      type="l", -->
<!--      col=viridis(2)) -->
<!-- # legend("topright", -->
<!-- #        legend = c("# Autoren != author_cnt", "# Affiliation != inst_cnt"), -->
<!-- #        fill=viridis(2), -->
<!-- #        bty = "n") -->
<!-- ``` -->
<h2 id="implementation-in-scopus">Implementation in Scopus</h2>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">DROP</span> <span class="kw">TABLE</span> items_iai_complete_scp;
<span class="kw">DROP</span> <span class="kw">TABLE</span> scopusb2017_frc_cntrylvl;

<span class="co">/*</span>
<span class="co">Create temporaray table as an indicator of items with complete iai record:</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">GLOBAL</span> <span class="kw">TEMPORARY</span> <span class="kw">TABLE</span> items_iai_complete_scp (
    fk_items <span class="dt">NUMBER</span>
)
<span class="kw">ON</span> <span class="kw">COMMIT</span> <span class="kw">DELETE</span> <span class="kw">ROWS</span>;

<span class="co">/*</span>
<span class="co">create empty table defining fractional weight for every paper by country</span>
<span class="co">causes implicit commit</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">TABLE</span> scopusb2017_frc_cntrylvl (
    fk_items <span class="dt">NUMBER</span>,
    countrycode <span class="dt">VARCHAR2</span>(<span class="dv">10</span> <span class="dt">CHAR</span>),
    frac_share <span class="dt">NUMBER</span>(<span class="dv">3</span>,<span class="dv">2</span>),
    ind_complete <span class="dt">NUMBER</span>(<span class="dv">1</span>,<span class="dv">0</span>)
);

<span class="co">/*</span>
<span class="co">populate temporary table</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> items_iai_complete_scp (
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items <span class="co">-- subset of items with complete iai information</span>
<span class="kw">FROM</span>( <span class="co">-- counts numbers of entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> scopus_b_2017.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2016</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp
<span class="kw">JOIN</span>( <span class="co">-- counts numbers of COMPLETE entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> scopus_b_2017.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2016</span>
        <span class="kw">AND</span> fk_institutions <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> fk_authors <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> <span class="kw">type</span> <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp2 <span class="kw">ON</span> tmp.fk_items = tmp2.fk_items
<span class="kw">AND</span> tmp.entry_cnt = tmp2.entry_cnt); <span class="co">-- compare both numbers</span>

<span class="co">/*</span>
<span class="co">include items with COMPLETE iai information via fractional counting on author level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> scopusb2017_frc_cntrylvl
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share, <span class="dv">1</span> <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution of organsation on author level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode, fk_authors,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> fk_authors) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items)))/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_authors)) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> scopus_b_2017.items it
      <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2016</span>
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete_scp)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode, <span class="dv">1</span>;

<span class="co">/*</span>
<span class="co">include items with INCOMPLETE iai information via fractional counting on organization level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> scopusb2017_frc_cntrylvl
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share, <span class="dv">0</span> <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution on organisation level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> scopus_b_2017.items it
      <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2016</span>
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete_scp)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode, <span class="dv">0</span>;

<span class="kw">CREATE</span> <span class="kw">INDEX</span> scpb2018_frc_cntrylvl_ix <span class="kw">ON</span> scopusb2017_frc_cntrylvl (fk_items, countrycode);

<span class="kw">COMMIT</span>;</code></pre></div>
<h2 id="comparison-with-isi-fractionation-on-organization1-1">Comparison with ISI fractionation on organization1</h2>
<p>As an alternative implementation we also compute weights based on fractionation on the <em>organization1</em> level:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">
<span class="co">/*</span>
<span class="co">create empty table defining fractional weight for every paper by country</span>
<span class="co">based on fractionation on organization1 level</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">TABLE</span> scopusb2017_frc_cntrylvl_org1 (
    fk_items <span class="dt">NUMBER</span>,
    countrycode <span class="dt">VARCHAR2</span>(<span class="dv">10</span> <span class="dt">CHAR</span>),
    frac_share <span class="dt">NUMBER</span>(<span class="dv">3</span>,<span class="dv">2</span>)
);

<span class="co">/*</span>
<span class="co">include items with INCOMPLETE iai information via fractional counting on organization level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> scopusb2017_frc_cntrylvl_org1
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution on organisation level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> scopus_b_2017.items it
      <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2016</span>
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode;

<span class="kw">CREATE</span> <span class="kw">INDEX</span> scpb2017_frc_cntrylvl_org1_idx <span class="kw">ON</span> scopusb2017_frc_cntrylvl_org1 (fk_items, countrycode);

<span class="kw">COMMIT</span>;</code></pre></div>
<p>Computing fractional counts of publications on national level for 2016:</p>
<pre><code>##    COUNTRY PUBYEAR PUB_CNT_FRAK COUNTRY PUBYEAR PUB_CNT_FRAK_ISI
## 1      CHN    2016    342649.60     CHN    2016        338204.02
## 2      USA    2016    333195.54     USA    2016        335849.18
## 3      IND    2016     87121.46     IND    2016         86700.66
## 4      GBR    2016     82915.05     GBR    2016         84107.96
## 5      DEU    2016     77642.77     DEU    2016         77418.07
## 6      JPN    2016     71628.66     JPN    2016         71793.26
## 7      ITA    2016     54316.43     KOR    2016         53907.14
## 8      KOR    2016     54093.73     FRA    2016         53757.73
## 9      FRA    2016     52950.69     ITA    2016         53678.30
## 10     CAN    2016     47786.34     CAN    2016         48078.08
## 11     ESP    2016     46862.25     ESP    2016         46517.16
## 12     BRA    2016     45468.12     BRA    2016         45066.48
## 13     RUS    2016     44004.81     RUS    2016         44208.74
## 14     NLD    2016     25578.36     NLD    2016         25380.92
## 15     POL    2016     24674.90     POL    2016         24586.92
## 16     CHE    2016     16855.87     CHE    2016         16936.08
## 17     SWE    2016     16671.90     SWE    2016         16809.12
## 18     BEL    2016     13405.68     BEL    2016         13273.06
## 19     DNK    2016     11332.21     DNK    2016         11300.38
## 20     ZAF    2016     10513.25     ZAF    2016         10538.46
## 21     ISR    2016     10165.89     ISR    2016         10152.20
## 22     AUT    2016      9151.00     AUT    2016          9140.63
## 23     FIN    2016      8538.39     FIN    2016          8489.98</code></pre>
<h1 id="summing-up">Summing up</h1>
<p>The implications of the adapted counting method seems rather minor on the chosen analysis level of countries.</p>
<p>Fractionation on the author level relies on complete information on the affiliations of single authors.</p>
<p>In the WoS the share of items with incomplete records constantly constitutes a substantial part of the corpus. Although data quality has strongly improved since 2008, still for 2017 more than 10% of all articles and reviews are incomplete. Furthermore data quality apparently gets improved every year, but the rate of improvement has slowed down considerably in the last years.</p>
<p>Socpus holds less incomplete recods, their share has been below 10% for all years since the first observation year 2007.</p>
<p>Consequently fractionizing on the author level seems only reasonable on complete records, whereas incomplete records might be fractionoized on the <em>organization1</em> level. Both approaches could be improved via a wordwide institution harmonization, which has partially be done by ISI Karlsruhe for their EFI reports.</p>
<h1 id="appendix">Appendix</h1>
<h2 id="kb-institution-encoding">KB institution encoding</h2>
<p>Fractionation weights are computed at the organiazation1 level (either with prior fractionation at the author level or due to incomplete information only on the organization1 level) and then transferred to the corresponding pk_kb_inst via the fk_institutions link. Consequently we assume that every pk_kb_inst constitutes a superset of organization1.</p>
<h3 id="implementation-for-wos_b_2018">Implementation for wos_b_2018</h3>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="co">/*</span>
<span class="co">create empty table defining fractional weight for every paper by country</span>
<span class="co">causes implicit commit</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">TABLE</span> wosb2018_frc_kbinstlvl (
    fk_items <span class="dt">NUMBER</span>,
    fk_kb_inst <span class="dt">NUMBER</span>,
    frac_share <span class="dt">NUMBER</span>(<span class="dv">3</span>,<span class="dv">2</span>),
    ind_complete <span class="dt">NUMBER</span>(<span class="dv">1</span>,<span class="dv">0</span>)
);

<span class="co">/*</span>
<span class="co">populate temporary table</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> items_iai_complete (
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items <span class="co">-- subset of items with complete iai information</span>
<span class="kw">FROM</span>( <span class="co">-- counts numbers of entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> wos_b_2018.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> (<span class="kw">role</span> <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> <span class="kw">role</span> = <span class="st">'author'</span>) <span class="co">-- we only care for authors and missing information, other roles are neglected</span>
        <span class="kw">AND</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp
<span class="kw">JOIN</span>( <span class="co">-- counts numbers of COMPLETE entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> wos_b_2018.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> fk_institutions <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> fk_authors <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> <span class="kw">role</span> = <span class="st">'author'</span>
        <span class="kw">AND</span> <span class="kw">type</span> <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp2 <span class="kw">ON</span> tmp.fk_items = tmp2.fk_items
<span class="kw">AND</span> tmp.entry_cnt = tmp2.entry_cnt); <span class="co">-- compare both numbers</span>

<span class="co">/*</span>
<span class="co">include items with COMPLETE iai information via fractional counting on author level and chained propagation via organization1 to pk_kb_inst:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> wosb2018_frc_kbinstlvl
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, fk_kb_inst, <span class="fu">SUM</span>(orga_share) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_kb_inst) <span class="kw">AS</span> frac_share, <span class="dv">1</span>
<span class="kw">FROM</span>(
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items, fk_authors, fk_kb_inst, ORGANIZATION1, orga_share
<span class="kw">FROM</span>( <span class="co">-- computing fractional contribution of organsation on author level, double counting on fk_instituions level</span>
  <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, fk_institutions, ORGANIZATION1, countrycode, fk_authors,
    (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> fk_authors) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items)))
    /(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_authors)) <span class="kw">AS</span> orga_share
  <span class="kw">FROM</span> wos_b_2018.items it
  <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
  <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
  <span class="kw">WHERE</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
    <span class="kw">AND</span> pubtype = <span class="st">'Journal'</span>
    <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
    <span class="kw">AND</span> <span class="kw">role</span> = <span class="st">'author'</span>
    <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
    <span class="kw">AND</span> pk_items <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
    <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
  ) tmp
  <span class="kw">JOIN</span> wos_b_2018.kb_a_wos_addr_inst adin <span class="kw">ON</span> adin.fk_institutions = tmp.fk_institutions
);

<span class="co">/*</span>
<span class="co">include items with INCOMPLETE iai information via fractional counting on organization level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> wosb2018_frc_kbinstlvl
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items, fk_kb_inst, orga_share <span class="kw">AS</span> frac_share, <span class="dv">0</span>
<span class="kw">FROM</span>(
    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, fk_institutions, organization1,
    (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) <span class="kw">AS</span> orga_share
    <span class="kw">FROM</span> wos_b_2018.items it
    <span class="kw">JOIN</span> wos_b_2018.items_authors_institutions iai <span class="kw">ON</span> iai.fk_items = it.pk_items
    <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> doctype <span class="kw">IN</span> (<span class="st">'Article'</span>, <span class="st">'Review'</span>)
        <span class="kw">AND</span> pubtype = <span class="st">'Journal'</span>
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> (<span class="kw">role</span> = <span class="st">'author'</span> <span class="kw">OR</span> <span class="kw">role</span> <span class="kw">IS</span> <span class="kw">NULL</span>)
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
    ) tmp
<span class="kw">JOIN</span> wos_b_2018.kb_a_wos_addr_inst adin <span class="kw">ON</span> adin.fk_institutions = tmp.fk_institutions;

<span class="kw">CREATE</span> <span class="kw">INDEX</span> wosb2018_frc_kbinstlvl_ix <span class="kw">ON</span> wosb2018_frc_kbinstlvl (fk_items, fk_kb_inst);

<span class="kw">COMMIT</span>;</code></pre></div>
<h3 id="implementation-for-scopus_b_2017">Implementation for scopus_b_2017</h3>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="co">/*</span>
<span class="co">create empty table defining fractional weight for every paper by country</span>
<span class="co">causes implicit commit</span>
<span class="co">*/</span>
<span class="kw">CREATE</span> <span class="kw">TABLE</span> scpb2017_frc_kbinstlvl (
    fk_items <span class="dt">NUMBER</span>,
    fk_kb_inst <span class="dt">NUMBER</span>,
    frac_share <span class="dt">NUMBER</span>(<span class="dv">3</span>,<span class="dv">2</span>),
    ind_complete <span class="dt">NUMBER</span>(<span class="dv">1</span>,<span class="dv">0</span>)
);

<span class="co">/*</span>
<span class="co">populate temporary table</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> items_iai_complete (
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items <span class="co">-- subset of items with complete iai information</span>
<span class="kw">FROM</span>( <span class="co">-- counts numbers of entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> scopus_b_2017.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp
<span class="kw">JOIN</span>( <span class="co">-- counts numbers of COMPLETE entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> scopus_b_2017.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> fk_institutions <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> fk_authors <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> <span class="kw">type</span> <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp2 <span class="kw">ON</span> tmp.fk_items = tmp2.fk_items
<span class="kw">AND</span> tmp.entry_cnt = tmp2.entry_cnt); <span class="co">-- compare both numbers</span>

<span class="co">/*</span>
<span class="co">include items with COMPLETE iai information via fractional counting on author level and chained propagation via organization1 to pk_kb_inst:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> scpb2017_frc_kbinstlvl
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, fk_kb_inst, <span class="fu">SUM</span>(orga_share) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_kb_inst) <span class="kw">AS</span> frac_share, <span class="dv">1</span>
<span class="kw">FROM</span>(
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items, fk_authors, fk_kb_inst, ORGANIZATION1, orga_share
<span class="kw">FROM</span>( <span class="co">-- computing fractional contribution of organsation on author level, double counting on fk_instituions level</span>
  <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, fk_institutions, ORGANIZATION1, countrycode, fk_authors,
    (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> fk_authors) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items)))
    /(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_authors)) <span class="kw">AS</span> orga_share
  <span class="kw">FROM</span> scopus_b_2017.items it
  <span class="kw">JOIN</span> scopus_b_2017.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
  <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
  <span class="kw">WHERE</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
    <span class="kw">AND</span> pubtype = <span class="st">'J'</span>
    <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
    <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
    <span class="kw">AND</span> pk_items <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
    <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
  ) tmp
  <span class="kw">JOIN</span> scopus_b_2017.kb_a_scp_addr_inst adin <span class="kw">ON</span> adin.fk_institutions = tmp.fk_institutions
);

<span class="co">/*</span>
<span class="co">include items with INCOMPLETE iai information via fractional counting on organization level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> scpb2017_frc_kbinstlvl
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items, fk_kb_inst, orga_share <span class="kw">AS</span> frac_share, <span class="dv">0</span>
<span class="kw">FROM</span>(
    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, fk_institutions, organization1,
    (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) <span class="kw">AS</span> orga_share
    <span class="kw">FROM</span> scopus_b_2017.items it
    <span class="kw">JOIN</span> scopus_b_2017.items_authors_institutions iai <span class="kw">ON</span> iai.fk_items = it.pk_items
    <span class="kw">JOIN</span> scopus_b_2017.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> doctype <span class="kw">IN</span> (<span class="st">'ar'</span>, <span class="st">'re'</span>)
        <span class="kw">AND</span> pubtype = <span class="st">'J'</span>
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
    ) tmp
<span class="kw">JOIN</span> scopus_b_2017.kb_a_scp_addr_inst adin <span class="kw">ON</span> adin.fk_institutions = tmp.fk_institutions;

<span class="kw">CREATE</span> <span class="kw">INDEX</span> scpb2017_frc_kbinstlvl_ix <span class="kw">ON</span> scpb2017_frc_kbinstlvl (fk_items, fk_kb_inst);

<span class="kw">COMMIT</span>;</code></pre></div>
<h2 id="conference-proceedings-web-of-science">Conference Proceedings Web of Science</h2>
<p>Percentages of pk_items with partially missing information:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">only pk_item</th>
<th align="right">no type</th>
<th align="right">no role</th>
<th align="right">no affiliation</th>
<th align="right">no author</th>
<th align="right">No Organization1</th>
<th align="right">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2007</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">15.0</td>
<td align="right">23.8</td>
<td align="right">15.0</td>
<td align="right">0.2</td>
<td align="right">24.1</td>
</tr>
<tr class="even">
<td>2008</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">8.8</td>
<td align="right">19.5</td>
<td align="right">8.8</td>
<td align="right">0.2</td>
<td align="right">19.7</td>
</tr>
<tr class="odd">
<td>2009</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">8.7</td>
<td align="right">19.3</td>
<td align="right">8.7</td>
<td align="right">0.2</td>
<td align="right">19.5</td>
</tr>
<tr class="even">
<td>2010</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">7.5</td>
<td align="right">17.4</td>
<td align="right">7.5</td>
<td align="right">0.2</td>
<td align="right">17.6</td>
</tr>
<tr class="odd">
<td>2011</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">7.1</td>
<td align="right">14.8</td>
<td align="right">7.1</td>
<td align="right">0.3</td>
<td align="right">15.1</td>
</tr>
<tr class="even">
<td>2012</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">7.1</td>
<td align="right">18.1</td>
<td align="right">7.1</td>
<td align="right">0.3</td>
<td align="right">18.4</td>
</tr>
<tr class="odd">
<td>2013</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">6.9</td>
<td align="right">15.9</td>
<td align="right">6.9</td>
<td align="right">0.3</td>
<td align="right">16.1</td>
</tr>
<tr class="even">
<td>2014</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">7.0</td>
<td align="right">11.0</td>
<td align="right">7.0</td>
<td align="right">0.2</td>
<td align="right">11.2</td>
</tr>
<tr class="odd">
<td>2015</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">3.1</td>
<td align="right">4.7</td>
<td align="right">3.1</td>
<td align="right">0.2</td>
<td align="right">4.9</td>
</tr>
<tr class="even">
<td>2016</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">1.0</td>
<td align="right">2.2</td>
<td align="right">1.0</td>
<td align="right">0.3</td>
<td align="right">2.7</td>
</tr>
<tr class="odd">
<td>2017</td>
<td align="center">0</td>
<td align="right">0</td>
<td align="right">0.9</td>
<td align="right">1.8</td>
<td align="right">0.9</td>
<td align="right">0.2</td>
<td align="right">2.3</td>
</tr>
</tbody>
</table>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAjVBMVEUAAAAAADoAAGYAOjoAOpAAZrYhkIwxaI41t3k6AAA6ADo6AGY6OgA6Ojo6OpA6kJA6kNtEAVREOoNmAABmADpmAGZmkJBmtrZmtv+P10SQOgCQOjqQZgCQkGaQtpCQ27aQ2/+2ZgC2tma225C2/7a2///bkDrb/7bb///95yX/tmb/25D//7b//9v////HBs9fAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATFklEQVR4nO3djXrbtgFGYbqN3TldN7XuWs9rN2truEySdf+XNwLgryRQAgmSH6HzPk9Tx3JIyznhP8jsCAjLlv4GgD4ECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmlhgX68ZdY3Xyb6doCuoEDzbOM+2FUfANMKCfTjrc4y//R1gm8GOBUS6OHltfpwx0oes2AJCmmB26DlIpRtUMwkbC/+8OL24ll+YiYcB4U0AoU0DtRDGgfqIY3DTJAW50B9Vov2jQFG5CUogSKuyAfqCRRxRT5QT6CIK3JRBCola+u+tHv1/Ka1p6GAQFOW/djo/tV0MvT/ZnkEmjICnXhyGMcb6P7Z7kjsijX/pvrNtvjN66oDrXaRek52EqiUK0vQXRHk4eXR/Wb7eDzmD+9rDvT48XbtJDyBSukP1B3X3j28m98cfn43C9bXVQdavKXHmJPDxPoDNTnaKKsmd1m28kDtSiHi5DCtWwItPrJN5sV223/WvgSde3IYJ2AJan+z+lX83JPDOP4D9WfboPbyn93qV/EzTw5TObxs2nvxm3LhmW0IFBK2zXFQ95tiG/ThfesWp0IIFNIIFNIIFNIIFNIIFNIIFNIIFNIINGX+M0nVhWnb8+Fl5vLQK5dcWBcPmO56TkXtvx9wQxoC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" /></p>
<p>Implementation:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">
<span class="co">/*</span>
<span class="co">populate temporary table</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> items_iai_complete (
<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> tmp.fk_items <span class="co">-- subset of items with complete iai information</span>
<span class="kw">FROM</span>( <span class="co">-- counts numbers of entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> wos_b_2018.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> (<span class="kw">role</span> <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> <span class="kw">role</span> = <span class="st">'author'</span>) <span class="co">-- we only care for authors and missing information, other roles are neglected</span>
        <span class="kw">AND</span> doctype = <span class="st">'Proceedings Paper'</span>
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp
<span class="kw">JOIN</span>( <span class="co">-- counts numbers of COMPLETE entries in iai for every item</span>
    <span class="kw">SELECT</span> fk_items, <span class="fu">COUNT</span> (*) <span class="kw">AS</span> entry_cnt
    <span class="kw">FROM</span> wos_b_2018.items it
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
    <span class="kw">LEFT</span> <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
    <span class="kw">WHERE</span> doctype = <span class="st">'Proceedings Paper'</span>
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> fk_institutions <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> fk_authors <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
        <span class="kw">AND</span> <span class="kw">role</span> = <span class="st">'author'</span>
        <span class="kw">AND</span> <span class="kw">type</span> <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items
) tmp2 <span class="kw">ON</span> tmp.fk_items = tmp2.fk_items
<span class="kw">AND</span> tmp.entry_cnt = tmp2.entry_cnt); <span class="co">-- compare both numbers</span>

<span class="co">/*</span>
<span class="co">include items with COMPLETE iai information via fractional counting on author level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> wosb2018_frc_cntrylvl
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share, <span class="dv">1</span> <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution of organsation on author level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode, fk_authors,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> fk_authors) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items)))
        /(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items, fk_authors)) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> wos_b_2018.items it
      <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> doctype = <span class="st">'Proceedings Paper'</span>
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> <span class="kw">role</span> = <span class="st">'author'</span>
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode, <span class="dv">1</span>;

<span class="co">/*</span>
<span class="co">include items with INCOMPLETE iai information via fractional counting on organization level:</span>
<span class="co">*/</span>
<span class="kw">INSERT</span> <span class="kw">INTO</span> wosb2018_frc_cntrylvl
<span class="kw">SELECT</span> fk_items, countrycode, <span class="fu">SUM</span>(orga_frak) <span class="kw">AS</span> frac_share, <span class="dv">0</span> <span class="co">-- aggregating on country level</span>
<span class="kw">FROM</span>( <span class="co">-- aggregating on organization1 level</span>
    <span class="kw">SELECT</span> fk_items, organization1, countrycode, <span class="fu">SUM</span>(orga_share)  <span class="kw">AS</span> orga_frak
    <span class="kw">FROM</span>( <span class="co">-- computing fractional contribution on organisation level</span>
      <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> fk_items, ORGANIZATION1, countrycode,
        (<span class="dv">1</span>/(<span class="fu">COUNT</span> (<span class="kw">DISTINCT</span> organization1) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> fk_items))) <span class="kw">AS</span> orga_share
      <span class="kw">FROM</span> wos_b_2018.items it
      <span class="kw">JOIN</span> wos_b_2018.ITEMS_AUTHORS_INSTITUTIONS iai <span class="kw">ON</span> it.pk_items = iai.fk_items
      <span class="kw">JOIN</span> wos_b_2018.institutions inst <span class="kw">ON</span> inst.pk_institutions = iai.fk_institutions
      <span class="kw">WHERE</span> doctype = <span class="st">'Proceedings Paper'</span>
        <span class="kw">AND</span> pubyear <span class="kw">BETWEEN</span> <span class="dv">2007</span> <span class="kw">AND</span> <span class="dv">2017</span>
        <span class="kw">AND</span> (<span class="kw">role</span> = <span class="st">'author'</span> <span class="kw">OR</span> <span class="kw">role</span> <span class="kw">IS</span> <span class="kw">NULL</span>)
        <span class="kw">AND</span> <span class="kw">type</span> = <span class="st">'RS'</span>
        <span class="kw">AND</span> pk_items <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> fk_items <span class="kw">FROM</span> items_iai_complete)
        <span class="kw">AND</span> organization1 <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
      )
    <span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, organization1, countrycode
)
<span class="kw">GROUP</span> <span class="kw">BY</span> fk_items, countrycode, <span class="dv">0</span>;

<span class="kw">COMMIT</span>;

<span class="kw">DROP</span> <span class="kw">INDEX</span> wosb2018_frc_cntrylvl_ix;
<span class="kw">CREATE</span> <span class="kw">INDEX</span> wosb2018_frc_cntrylvl_ix <span class="kw">ON</span> wosb2018_frc_cntrylvl (fk_items, countrycode);

<span class="kw">COMMIT</span>;</code></pre></div>
<h1 id="literatur">Literatur</h1>
<p>Waltman, L. and Eck, N.J. van. (2015), “Field-normalized citation impact indicators and the choice of an appropriate counting method”, <em>Journal of Informetrics</em>, Vol. 9 No. 4, pp. 872–894.</p>

</body>
</html>
